#!/bin/bash

# add local bin to path so that log-entry will run
export PATH="$HOME/.local/bin:$PATH"

# Start all containers that match a given name
docker-start() {
	containers=$(docker ps --filter "status=exited" --filter "name=$*" --format "{{.ID}}")

	if [[ -n "$containers" ]]; then echo "$containers" | xargs docker start; else return 1; fi
}

echo 'Starting Containers:'

if docker-start "immich"; then log-entry "INFO" "Started immich"; else log-entry "ERROR" "Failed to start immich"; fi

if docker-start "full-text-rss"; then log-entry "INFO" "Started full-text-rss"; else log-entry "ERROR" "Failed to start full-text-rss"; fi

if docker-start "freshrss"; then log-entry "INFO" "Started freshrss"; else log-entry "ERROR" "Failed to start freshrss"; fi

if docker-start "audiobookshelf_abs-tract"; then log-entry "INFO" "Started abs-tract"; else log-entry "ERROR" "Failed to start abs-tract"; fi
